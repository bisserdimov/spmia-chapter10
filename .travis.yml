language: java
jdk:
- oraclejdk8
cache:
  directories:
  - "$HOME/.m2"
sudo: required
services:
- docker
notifications:
  email:
  - biss_dimov@hotmail.com
  on_success: always
  on_failure: always
branches:
  only:
  - master
env:
  global:
  - secure: S8scLAy2j6MgAEtYlgyV4bpiQwBTwaCRKIq4Ftd3kOmz51cvhi5s8HObGqR6pmyG/7lRWskKsRJbPz3HjYxxJeouHfl4uDteFEh1FCnLKTcg5c09olYFP+UlQeDEQ3rKiSxVFHGtAfXaFK1OY6E6VAy9NT5RlVcnQxMYK+joX4a5JAInvQVFVY+nl2jq0mTNcXbISz4g11x7tifik3Kajh7n/SquC0Bz/scf8wIRL3pjXA5Fm7catMcnuBHMS4RxlpuSgVMz8yClqfcF7QY7CfBeVjWpwTi7zHNGPlMsEDmgq+Eh5L+ygDffPwr3WDZc5fN6NOdWFEf2oWc8NngZrNiiDnIkHh15eZQAmS/p2tUfVQMjqv8frSQma+E02CNrjhBPnmLWTIDiNrCLglPOZzeE1wlv7+L49r+q/h0oC63IyaQCz4UcK7hfC1fDxuuWQ6yHTXAFfI8wToc/CyWk9KBbSHhX25AVEq8a1bRt2DYZkAFhFgkjpgmJbtMbETnf91uFapOEX5v5I7PgsFgdy/MT4ssk/EXr1ZdewzsYkY3lJV+UmvUjngFdbo/1gEsNNHH4nO2/nx7JT67x8WYslrimZVei3w5LvuD6Pj84VUVv37tuoavwZ8kfnDRf2zHsM+K3R6nB8VEp5NWxWZPks5pB377gEtsl2MTDjugSea4=
  - secure: GOWMS31afC3p+EIehW7nq/w0QYT3xBVJKC2yoNwNLUgO3Eg+9nJcx3nkNgnhjBm2JiW3JGvtOXIVm7CzXXYKF3QpQjjZdvGtzYKf2si4G53Hf6bbvuPxYSYDhcXpFi/CRfM5YvsyG5OBIpCfhIe+pYU1UbzgES46ASh7rao0c7vA1zIEbmaU+Z+iEF6tzVEe4Oe7jkimdAHatwlg9nVaqwOrWLt8gK409dgpVMq5PrKtPFad0DMlqFs5ACE3sjPZYNrtl7U7K7x50hli+092DnLFUAKGNPsz6pNdt04g/k1cggX4kFG5vUsOe79t1vQ5s/ByirOLhOMycOcfnjfYsZdIhnngEFM7tFEQuUYoRgG1kGqlR2xIctDfCN5hL7eiW3cTcWEXep7xZhRJjO+prlVEI1MpZbhjRCJGBYRutg9p52e3b2x29BXPZin9CJPnyMM8X9H4QXWHgftAYQWwOrUIOg6SkLOHrv1u+oXPdYrjuwW6dfNH4Viun+UMxvCVd3yud31FEzEPs3hChMJzBMZLPAe7XA7QXCLhHhJPHlo+kiy2vQ2j2HPu21nntKflcUQHEexQiQtWph/CkhE4ivg/wg9PZJkAhxrCBq9R8tSrDka8GYUIvfYwkuS+SJOGUTBXbPmvARTCKmX+WKeCEVx1SE1FA9UwzGGzaPvJuiA=
  - secure: TvWirRg0DDBnXJ/V9XZQJ+a11aBFbi+T7iPdcnTBymV0zyQ6bMlvMhZbkW90X3TLM+yM91WBF+iIhEad406JymacmypOHc/WDZJB5FefRysCE2Fhlngymhj4qco6bYzg1WcYkPpt2rSpt2GQhLdO8+i5ofEzX6FNdby8Mc12bNviZcJgsxdSfRXfPlGGVz2zWH02GP0uJ2vUnvMD4NTZvlLkPaK6NHEkAT+Kiu5J4cq/BVExJc0FBivuLGOW/RF54GAiURNLh2fwFfnmWpg3JY/z7fGGM4gCYfuBzCGBJvMslfwLfGCrQZqOQUNSFNqhIMsk1TIjZb6hMedCakYVcopwyJ1spa2DwI4AoPlYAl3jPLuTdz121Ox29Zc4gT/B6yvQ9Cz62/OPnMZs2pBBzET6/0oGyQX4hJD9bJ7hEcr2I5sHf0EvR3xlAXAsRmn7i72Lh5L/xDNwSDGIvpqPQLzNhqU4bMWHegnd1IuMIt+9uJHahqcVDUXeyMvQ7xwNoZ8GkNcHQ8Yf/82twsknFQ04uqFfNQgYdwckNo1O7OWZPPFvw1EyyN65y3nE4WFDb4l6ZeHkqvWhKEGgEfOwMz7RLKUxp1aN8ymhaEogTKmx7arxRtD+iaTATYXJlWFclSYWvzt0ajllgJVI3T02syGq4vtJGb0h8aKGbZkuRH8=
  - secure: moeHgjHOQSUCILmBUHvNFjp/4lFMwHXHXBT76auc4v1O1m9PJIUi2fejixZSPwZCkTYoK9hYX8OQ/Zb9BOjYs6rna9uocVxBntR2lZ3xiN3cTpv/oWMAzWPyKxUOyCs2FSoeY4XK3UeIeLgsv5YuLAjg0WzfoORXHJKpDWvJyHBTRJCDru+ZuyiBMtm3MSIdBHz95nghcHQb4vv+GkOkw2CATK9iyoVuwCOQAFpNeRQU71OCHPmw3adNRmduAhFzLZDRrgNJ/xJ4cJra5oM0vX/5i+j7kes/g7oxMHUmYGljmg5YtOpDaHCHacNQ9eibw6MxX0i/8oYicy1ATuF+0ncrc5CSTQOAv4nRbkVFvfyU43XOyLcjY9e01nDQNIcuUqRDYLEU9fPqt83QMb5bq06TkwuKn3zF32YulXwMuYt1Ka4oDfry2j7ndjlwmgiFSftLc6ziJXxk0/Eq7yu+r9ifJaYCHqqJoQyPu76uO3gHPy0H0kYG8841J63bYfLlYbIjjeJ3k10YWRUue/5J35dDVEYa9cPZTpkIQmzYmCwk798P7OHk28gYqqDIHjhEYKcEBTJnFeX6oAvB6QwXDIZ6jEtoWd/7LzKni8M5pOY4GohY5VBWc60nJh/zuZCIQOOm2QRVdRV0LAl+wSqg0SBN+GTZf8H040VT+UXACz4=
  - secure: JW8/gvXtt/ksn7BOvwCytQxSeMuqJGVqanK41Xr+XVGJJ70cko3XG04WKru+yc0vHrTdaVp2fnGfTTYSMMmFfjtjl8x1g7r4LTibYz56nCswFdy47Ni0t8et7r5c+TxJTMjxqxpPBUxVQWRjZynNLAp6XSLUEfE0cV5RPEoeICSlLGXW226qcyDFq2TweXG06fAMcQmNMtvhc/6CXjKs1cSz5xXKV6TpDPJC/7RrsTMu0oAEMU7g2HWsaPr9XCEK+uOzpVZ6ess5MAYzuv0TlE9606AY/C/JkxtLqyNNMDLRIl9oYTYjsqTwwxmci55yHDM8On+AOqUUP6rAQmgBP83k839tlocmla1u9Y7oSYDzTnOn5a8V58uhUFCN869SdhhAavmLnVY2Ps6hI984OD/5JrH5w7JCT1Rm1Q9PNP3noqBfGe1rSxreJxhdojtdoq0JlH5kCUtoaLVb4BGM2c8J9z7ynPcwa/ql5V9drdfWs1FA1+juWTK32aYsiCIy8EZL/rNP40+M59N+T8wV6hd8WwcVdQPmAUzlHEHVNyopTvdGX+HE/3o68oJjLHsk+mewdVtXrLKctWnF56IobHJHXNjqUGjv9Uh4IO+pIQqmZUL6qoCE2cwQ+yBBGQpUsc29ARhAotFNEIpX5tGoRwWRzhN+75GwHaJ8Fmble9k=
before_install:
- gem install travis -v 1.8.5 --no-rdoc --no-ri
- sudo curl -k -o /usr/local/bin/ecs-cli https://s3.amazonaws.com/amazon-ecs-cli/ecs-cli-linux-amd64-latest
- sudo chmod +x /usr/local/bin/ecs-cli
- export BUILD_NAME=chapter10-$TRAVIS_BRANCH-$(date -u "+%Y%m%d%H%M%S")-$TRAVIS_BUILD_NUMBER
- export CONTAINER_IP=18.191.95.13
- export PLATFORM_TEST_NAME="chapter10-platform-tests"
script:
- sh travis_scripts/tag_build.sh
- sh travis_scripts/build_services.sh
- sh travis_scripts/deploy_to_docker_hub.sh
- sh travis_scripts/deploy_to_amazon_ecs.sh
- sh travis_scripts/deploy_to_amazon_ecs.sh
# sh travis_scripts/trigger_platform_tests.sh
